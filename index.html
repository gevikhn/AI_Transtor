<!DOCTYPE html><html lang="zh-cn"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width,initial-scale=1"/><title>AI Transtor</title><link rel="stylesheet" href="css/base.css"/><link rel="manifest" href="manifest.webmanifest"/><meta name="theme-color" content="#0d0f11"/><meta http-equiv="Content-Security-Policy" content="default-src 'self'; connect-src 'self' https:; style-src 'self' 'unsafe-inline'; script-src 'self';"/></head>
<body>
<header class="bar"><h1 class="app-title">AI Transtor <small id="buildInfo" style="font-weight:normal;font-size:0.6em;opacity:0.7"></small></h1></header>
<main class="layout">
  <section class="controls">
    <label><select id="serviceSelect"></select></label>
    <label><select id="langSelect" data-ref="lang"></select></label>
    <div class="btn-row">
      <button id="btnTranslate" class="btn primary">翻译 (Ctrl+Enter)</button>
      <button id="btnClear" class="btn">清空</button>
      <button id="btnCopy" class="btn">复制结果</button>
      <nav><button id="openSettings" class="btn">设置</button></nav>
    </div>
  </section>
  <section class="panes">
    <div class="pane">
      <textarea id="inputText" placeholder="在此粘贴或拖拽待翻译文本（含 .txt 文件）" spellcheck="false"></textarea>
    </div>
    <div class="pane">
      <textarea id="outputText" readonly placeholder="译文输出 (流式)..."></textarea>
    </div>
  </section>
  <section class="status" id="statusBar" aria-live="polite">待机</section>
</main>
<!-- 设置模态 -->
<div id="settingsOverlay" class="modal-overlay" hidden>
  <div class="modal" role="dialog" aria-modal="true" aria-labelledby="settingsTitle">
    <header class="modal-bar">
      <h2 id="settingsTitle">设置</h2>
      <div class="flex-gap"></div>
      <button id="closeSettings" class="btn">关闭 (Esc)</button>
    </header>
    <div class="modal-body">
      <form id="settingsForm">
        <fieldset><legend>服务配置</legend>
          <div class="btn-row" style="gap:.5rem;align-items:flex-end;flex-wrap:wrap">
            <label>当前服务 <select id="svcSelect"></select></label>
            <label>名称 <input id="svcName" type="text" placeholder="服务名称"/></label>
            <button type="button" id="btnAddSvc" class="btn">新增配置</button>
            <button type="button" id="btnDelSvc" class="btn danger">删除配置</button>
          </div>
        </fieldset>
        <fieldset><legend>全局</legend>
          <label>主密码 (解锁用) <input name="masterPassword" id="masterPassword" data-field="masterPassword" type="password" placeholder="留空则使用默认密钥" autocomplete="new-password"/></label>
          <label>默认目标语言 <select name="targetLanguage" data-field="targetLanguage"></select></label>
          <label>Prompt 模板</label>
          <textarea name="promptTemplate" data-field="promptTemplate" rows="10" placeholder="Prompt 模板"></textarea>
        </fieldset>
        <fieldset><legend>基础</legend>
          <label>API 类型 <select name="apiType" data-field="apiType">
            <option value="openai-responses">OpenAI Responses API</option>
            <option value="openai-chat">OpenAI Chat Completions</option>
            <option value="claude">Claude (Anthropic)</option>
          </select></label>
          <label>Base URL <input name="baseUrl" data-field="baseUrl" placeholder="https://api.openai.com/v1" required/></label>
          <label>API Key <input name="apiKey" data-field="apiKey" type="password" placeholder="sk-..." autocomplete="off"/></label>
          <label>模型 <input name="model" data-field="model" placeholder="gpt-4o-mini / claude-3-5-sonnet"/></label>
        </fieldset>
        <fieldset><legend>高级</legend>
          <label>流式输出 <input type="checkbox" name="stream" data-field="stream"/></label>
          <label>Temperature <input type="number" step="0.1" min="0" max="2" name="temperature" data-field="temperature"/></label>
          <label>Max Tokens <input type="number" min="1" name="maxTokens" data-field="maxTokens"/></label>
          <label>超时(ms) <input type="number" min="1000" name="timeoutMs" data-field="timeoutMs" placeholder="30000"/></label>
          <label>重试次数 <input type="number" min="0" max="5" name="retries" data-field="retries" placeholder="2"/></label>
          <label>Store Responses <input type="checkbox" name="storeResponses" data-field="storeResponses"/></label>
        </fieldset>
        <div class="btn-row">
          <button type="submit" class="btn primary">保存</button>
          <button type="button" id="btnTest" class="btn">连通性测试</button>
          <button type="button" id="btnExport" class="btn">导出(含密文)</button>
          <button type="button" id="btnExportSafe" class="btn">安全导出(不含Key)</button>
          <button type="button" id="btnImport" class="btn">导入</button>
          <button type="button" id="btnNewSession" class="btn">新建会话</button>
          <button type="button" id="btnDeleteSession" class="btn danger">删除会话</button>
        </div>
      </form>
      <input type="file" id="importFile" accept="application/json" hidden />
      <section id="settingsStatus" class="status" aria-live="polite">未修改</section>
    </div>
  </div>
</div>
<script type="module" src="js/ui-translate.js"></script>
<script type="module" src="js/ui-settings-modal.js"></script><script type="module" src="js/pwa.js"></script>
</body></html>
